# HTTPS/SSL/TLS
### http与https
1. HTTP和HTTPS的基本概念
+ HTTP:是互联网上应用最为广泛的一种网络协议,是一个客户端和服务器端请求和应答的标准(TCP),用于从WWW服务器传输超文本到本地浏览器的传输协议,它可以使浏览器更加高效,使网络传输减少.
+ HTTPS:是以安全为目标的HTTP通道,简单讲是HTTP的安全版,即HTTP下加入SSL层,HTTPS的安全基础是SSL,因此加密的详细内容就需要SSL.
+ HTTPS协议的主要作用可以分为两种:一种是建立一个信息安全通道,来保证数据传输的安全；另一种就是确认网站的真实性.
2. HTTP与HTTPS有什么区别？
1. HTTP协议传输的数据都是未加密的,也就是明文的,因此使用HTTP协议传输隐私信息非常不安全,为了保证这些隐私数据能加密传输,于是网景公司设计了SSL(Secure Sockets Layer)协议用于对HTTP协议传输的数据进行加密,从而就诞生了HTTPS.简单来说,HTTPS协议是由SSL+HTTP协议构建的可进行加密传输.身份认证的网络协议,要比http协议安全.
2. HTTPS和HTTP的区别主要如下:
+ https协议需要到ca申请证书,一般免费证书较少,因而需要一定费用.
+ http是超文本传输协议,信息是明文传输,https则是具有安全性的ssl加密传输协议.
+ http和https使用的是完全不同的连接方式,用的端口也不一样,前者是80,后者是443.
+ http的连接很简单,是无状态的；HTTPS协议是由SSL+HTTP协议构建的可进行加密传输.身份认证的网络协议,比http协议安全.
---
### SSL/TLS
+ https比http安全的原因就是它在TCP协议之上加入了SSL(Secure Sockets Layer 安全套接字协议)
+ 众所周知,http(s)协议是工作在应用层,而其下就是传输层,而http(s)协议是基于传输层中的TCP协议之上的,就是说http(s)的数据传输是要在TCP三次握手后,也就是建立连接的基础上才能进行http(s)通信,原本的http协议直接就是TCP握手完,就用明文传输数据,而https协议则是在TCP协议之上加入了SSL加密协议,在传输数据之前先进行加密,那TLS(Transport Layer Security)又是什么呢？简单点说,TLS就是规范化的SSL,早期TCP上的https传输用的加密协议是SSL,等到SSL发展到3.0之后,有一个国际机构将其标准化,标准化之后的SSL就叫做TLS,不过人们还是习惯叫SSL,现在大部分用的就是TLS,不过大家喜欢叫做SSL而已,就一回事.
---
### 对称加密/非对称加密
**SSL是加密协议,密码学的基本概念**
1. 密钥:就是用来加密解密的东西
2. 对称密钥:这是对于交流双方来说的,就是说交流双方用来加密解密的工具是一样的,举个例子,比如说我想写一封情书给女神,但我不想别人窃取到我写了什么,我就和女神约定,我会用咸鱼来加密,你用咸鱼就可以解密
3. 非对称密钥:分为公钥和私钥,注意公钥和私钥的概念只在非对称加密中出现,为了说明什么是公钥和私钥,举个例子,假设有一个检举机构,它接受广大人民群众的实名举报信,但为了不让举报人的名字泄露,就要进行加密,于是他就会生成一对公钥和私钥,把公钥告诉群众,说谁想举报就用这个公钥加密,只有我有私钥可以解密,大家放心.
**在此之上,加密方案分为两种**
+ 对称加密:双方使用的同一个密钥,既可以加密又可以解密,这种加密方法称为对称加密,也称为单密钥加密.
+ 非对称加密:一对密钥由公钥和私钥组成(可以使用很多对密钥).私钥解密公钥加密数据,公钥解密私钥加密数据(私钥公钥可以互相加密解密)
**扩展**
+ 常见的对称加密算法:AES,DES,3DES
+ 常见的非对称加密算法:RSA,DSA,ECC
---
### 数字签名,数字证书
1. 数字签名
回到刚才实名举报的例子,举报信的传输是安全了(因为只有检举机构的私钥能解密),那如果检举机构想对举报人回信,在举报人的角度怎么能证实收到的回信是检举机构发的呢？
在现实中很简单,不就盖个章嘛(不考虑被伪造的情况)
这个章在密码学里叫数字签名,既表明自己身份唯一的标识
那这个签名怎么签呢？
假如我是检举机构,我的回信叫letter

1. letter内容+Hash函数——>摘要

2. 摘要+私钥——>数字签名

3. 将数字签名放在letter内容的下面发送给举报人

**注意:在数字签名的过程中,只有私钥是具有唯一性的,hash函数是公开的,letter内容可能被截获修改!**

**对于举报人,关心的只有两点:1.信是不是检举机构寄的？ 2.信的内容有没有被黑客修改？如果上诉两点一旦确认为 1.是 2.没有  那这封信就无误**

那怎么求证呢？我们看举报人收到了什么内容,有*信的内容和数字签名*

对于第一点:1.信是不是检举机构寄的？

因为私钥是检举机构的唯一标识,只能通过验证数字签名来求证

数字签名+公钥,如果能成功得到摘要就确定数字签名没有被伪造,既信是检举机构寄的

对于第二点: 2.信的内容有没有被黑客修改？

前文说过,hash是公开的,如果上面验证了数字签名的正确性,那摘要就是可以反应原文的,所以

letter内容+hash 得到摘要,再与上面解密数字签名的摘要对比,一样的话就是没有修改

2. 数字证书
有朋友说,有数字签名,双方不就可以安全通信了吗,那数字证书是什么？

上面一切可靠通信的前提是,举报人手持的公钥和检举单位的私钥是一对

当举报人手上的公钥被恶意替换成某诈骗公司的公钥之后,诈骗公司就可以伪装成检举机构和举报人通信而不被发现,因为诈骗公司本身就拥有自己的私钥,而且把举报人的公钥替换成了自己的公钥,而举报人根本发现不了,还以为自己跟检举机构安全保密的通信呢.
这时候就要数字证书登场了！

**证书中心(certificate authority,简称CA)用自己的私钥,检举机构的公钥和一些相关信息一起加密,生成"数字证书"(Digital Certificate).**
*数字证书保证了检举机构和对应公钥的匹配性*
就是说,检举机构下次寄信时带上这个数字证书,举报人用CA的公钥解密的到检举机构的公钥,和客户端(浏览器)的"证书管理器",有"受信任的根证书颁发机构"列表对比,如果在上面就可以,不在上面就是假的公钥.

**扩展:有的朋友就说了,那如果CA的公钥被替换了怎么办？**
有兴趣的朋友可以去了解一下这种情况,称为中间人攻击,既黑客组织同时冒充服务端和客户端进行双向伪装通信
### SSL在http的应用
言归正传,说回SSL
##### SSL加密过程

1. 浏览器向服务器发起https请求

2. 服务器返回公钥和数字证书

3. 浏览器检查证书是不是由可以信赖的机构颁发的,确认证书有效和此证书是此网站的

4. 使用公钥加密了一个随机对称密钥,包括加密的URL一起发送到服务器

5. 服务器用自己的私匙解密了你发送的钥匙.然后用这把对称加密的钥匙给你请求的URL链接解密

6. 服务器用你发的对称钥匙给你请求的网页加密.你也有相同的钥匙就可以解密发回来的网页了

**连接的时候使用非对称加密,确认服务器正确无误后,生成对称密钥,在以后的通信中采用对称加密,加快速度.**

